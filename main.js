(()=>{var e={341:e=>{e.exports=function(){const e=document.querySelector("main"),t=new Map;function n(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function a(){return document.querySelector(".ship-placing")}function r(){return"true"==a().dataset.vertical}function i(e){const t=document.querySelector(".info-container");n(t);let a=document.createElement("h2");a.textContent=e,t.appendChild(a)}function l(e){let t=document.createElement("div");t.classList.add("grid");for(let n=10;n>0;n--)for(let a=1;a<11;a++){let r=document.createElement("div");r.classList.add("tile"),r.dataset.x=a,r.dataset.y=n,e&&e(r),t.appendChild(r)}return t}function o(e,t,n=!0){let a=[],r=null;r=n?document.querySelector(".player-grid").querySelectorAll(`[data-x="${e}"]`):document.querySelector(".computer-grid").querySelectorAll(`[data-x="${e}"]`),a=Array.from(r);for(let e=0;e<a.length;e++)if(a[e].dataset.y==t)return a[e]}return t.set("Carrier",["images/Carrier.png","images/CarrierHorizontal.png"]),t.set("Battleship",["images/Battleship.png","images/BattleshipHorizontal.png"]),t.set("Destroyer",["images/Destroyer.png","images/DestroyerHorizontal.png"]),t.set("Submarine",["images/Submarine.png","images/SubmarineHorizontal.png"]),t.set("Patrol Boat",["images/Patrol.png","images/PatrolHorizontal.png"]),{loadStartScreen:function(){n(e);let t=document.createElement("h2");t.style.marginTop="30px";let a=document.createElement("input"),r=document.createElement("button");return t.textContent="Enter Player Name:",a.type="text",a.id="player-name-input",a.maxLength="20",r.id="start-game-button",r.textContent="Start Game",e.appendChild(t),e.appendChild(a),e.appendChild(r),r},fadeIn:async function(){let t=0;return e.style.opacity=t,new Promise((function(n){let a=setInterval((()=>{t>=1&&(clearInterval(a),n(!0)),t+=.05,e.style.opacity=t}),50)}))},fadeInLogo:function(){const e=document.querySelector(".logo-text");let t=0;e.style.opacity=t;let n=setInterval((()=>{t>=1&&clearInterval(n),t+=.05,e.style.opacity=t}),50)},fadeOut:function(t){let n=1;e.style.opacity=n;let a=setInterval((()=>{n<=0&&(clearInterval(a),t()),n-=.05,e.style.opacity=n}),50)},loadGameScreen:function(t,a){let r=document.querySelector("#player-name-input").value;n(e);let i=document.createElement("div");i.classList.add("game-container");let o=document.createElement("div");o.classList.add("info-container");let c=document.createElement("div");c.classList.add("grids-container");let s=l(a);s.classList.add("player-grid"),c.appendChild(s),i.appendChild(o),i.appendChild(c),e.appendChild(i),t(r)},loadShipSelect:function(e,a,r){const i=document.querySelector(".info-container");n(i);let l=document.createElement("h2");l.textContent=`Place your ${a} (drag and drop)`;let o=document.createElement("div");o.classList.add("ship-row");let c=document.createElement("button");c.textContent="Axis: Y",c.classList.add("axis-button");let s=document.createElement("img");s.src=t.get(a)[0],s.draggable="true",s.classList.add("ship-placing"),s.dataset.vertical="true",s.dataset.length=r,s.dataset.name=a,o.appendChild(s),o.appendChild(c),i.appendChild(l),i.appendChild(o),e(s,c)},getCurrentShip:a,placementIsVertical:r,getTile:o,placeShipOnGrid:function(e,t,n){let r=new Image;r.src=a().src;let i=o(e,t,!0);n?r.classList.add("centered-ship-vertical"):r.classList.add("centered-ship-horizontal"),i.appendChild(r)},changeAxis:function(){let e=a(),n=document.querySelector(".axis-button");r()?(e.dataset.vertical="false",e.src=t.get(e.dataset.name)[1],n.textContent="Axis: X"):(e.dataset.vertical="true",e.src=t.get(e.dataset.name)[0],n.textContent="Axis: Y")},setGameLoopScreen:function(e){let t=document.querySelector(".grids-container"),a=document.querySelector(".info-container");document.querySelector("header").style.paddingBottom="15px",n(t),n(a),a.style.height="50px",a.style.padding="0 20px";let r=l(),i=l(e),o=document.createElement("h3"),c=document.createElement("h3");o.textContent="Friendly Water",c.textContent="Enemy Water";let s=document.createElement("div"),d=document.createElement("div");s.classList.add("player-grid-container"),d.classList.add("computer-grid-container"),r.classList.add("player-grid"),s.appendChild(o),s.appendChild(r),i.classList.add("computer-grid"),d.appendChild(c),d.appendChild(i),t.appendChild(d),t.appendChild(s)},clearElement:n,placeShipOnGridGameLoop:function(e){let n=new Image,a=o(e.startPosX,e.startPosY);e.isVertical?(n.src=t.get(e.name)[0],n.classList.add("centered-ship-vertical")):(n.src=t.get(e.name)[1],n.classList.add("centered-ship-horizontal")),a.appendChild(n)},tileHit:function(e,n,a,r,l){let c=o(e,n,a),s=document.createElement("div");s.classList.add("tile-hit"),c.appendChild(s),l.isSunk()?a?i(`${r} fires at (${e},${n}) and sinks your ${l.name}!`):(i(`Direct hit! you sank the Computer's ${l.name}!`),function(e,n,a,r){let i=new Image,l=o(n,a,!1);r?(i.src=t.get(e)[0],i.classList.add("centered-ship-vertical")):(i.src=t.get(e)[1],i.classList.add("centered-ship-horizontal")),l.appendChild(i)}(l.name,l.startPosX,l.startPosY,l.isVertical)):i(`${r} fires at (${e},${n}) and scores a direct hit!`)},tileMiss:function(e,t,n,a){let r=o(e,t,n),l=document.createElement("div");l.classList.add("tile-miss"),r.appendChild(l),i(`${a} fires at (${e},${t}) and misses.`)},gameover:function(e,t){let a=document.querySelector(".info-container"),r=document.createElement("h2");n(a),r.textContent=`${e} has won!`;let i=document.createElement("button");i.textContent="Play Again",a.appendChild(r),a.appendChild(i),t(i)},aiming:function(e){i(`${e} is taking aim...`)}}}},843:e=>{e.exports=class{constructor(e,t,n){this.computer=e,this.player=t,this.ships=n,this.lastHit=null}attemptAttack(){let e=null;e=this.lastHit?this.findShipSinkTile():this.findAttackableTile();let t={x:e.x,y:e.y,ship:null};return t.ship=this.player.attemptReceiveAttack(e.x,e.y),t.ship&&(t.ship.isSunk()?this.lastHit=null:this.lastHit=t),t}findShipSinkTile(){let e=this.lastHit.ship.posArray;for(let t=0;t<e.length;t++){let n=e[t];if(!n.isHit)continue;let a=[{x:n.x+1,y:n.y},{x:n.x-1,y:n.y},{x:n.x,y:n.y+1},{x:n.x,y:n.y-1}];this.shuffleArray(a),console.log(a);for(let e=0;e<a.length;e++)if(a[e].x<11&&a[e].x>0&&a[e].y<11&&a[e].y>0&&this.player.checkIfAttackable(a[e].x,a[e].y))return{x:a[e].x,y:a[e].y}}}findAttackableTile(){let e,t;for(;;)if(e=this.getRandomInt(1,11),t=this.getRandomInt(1,11),this.player.checkIfAttackable(e,t))return{x:e,y:t}}shuffleArray(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}}getRandomInt(e,t){return Math.floor(Math.random()*(t-e)+e)}placeShips(){this.ships.forEach((e=>{let t,n,a;for(;;)if(t=this.getRandomInt(1,11),n=this.getRandomInt(1,11),a=this.getRandomInt(1,3)>1,this.computer.checkPlaceable(e.length,t,n,a)){this.computer.attemptPlaceShip(e.length,t,n,a,e.name);break}}))}}},529:(e,t,n)=>{const a=n(922);e.exports=function(){const e=[];function t(t,r,i,l,o){return!!n(t,r,i,l)&&(e.push(a(t,r,i,l,o)),!0)}function n(e,t,n,a){if(a){if(Number(e)+Number(n)>11)return!1;for(let a=n;a<e+n;a++)if(!r(t,a))return!1}else{if(Number(e)+Number(t)>11)return!1;for(let a=t;a<e+t;a++)if(!r(a,n))return!1}return!0}function r(t,n){for(let a=0;a<e.length;a++)if(!e[a].checkAvailable(t,n))return!1;return!0}return{placeShip:t,receiveAttack:function(t,n){let a=!1;for(let r=0;r<e.length;r++){let i=e[r].hit(t,n);if(i){a=i;break}}return a},allSunk:function(){for(let t=0;t<e.length;t++)if(!e[t].isSunk())return!1;return!0},checkAvailable:r,placeShip:t,checkPlaceable:n,getShips:function(){return e}}}},874:(e,t,n)=>{const a=n(529);e.exports=function(e){const t=a(),n=[];return{getName:function(){return e},attemptPlaceShip:function(e,n,a,r,i){return t.placeShip(e,n,a,r,i)},checkIfAttackable:function(e,t){return!n.find((n=>n[0]===e&&n[1]===t))},attemptReceiveAttack:function(e,a){return n.push([e,a]),t.receiveAttack(e,a)},checkPlaceable:function(e,n,a,r){return t.checkPlaceable(e,n,a,r)},getShips:function(){return t.getShips()},allSunk:function(){return t.allSunk()}}}},922:e=>{e.exports=function(e,t,n,a,r){const i=[];if(a)for(let a=n;a<n+e;a++)i.push({x:t,y:a,isHit:!1});else for(let a=t;a<t+e;a++)i.push({x:a,y:n,isHit:!1});return{hit:function(e,t){const n=i.find((n=>n.x==e&&n.y==t));return null!=n&&(n.isHit=!0,this)},isSunk:function(){let e=!0;return i.forEach((t=>{!1===t.isHit&&(e=!1)})),e},checkAvailable:function(e,t){return null==i.find((n=>n.x===e&&n.y===t))},startPosX:t,startPosY:n,isVertical:a,length:e,name:r,posArray:i}}}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}(()=>{const e=n(874),t=n(341),a=n(843);let r=t(),i=null,l=null,o=null,c=!0,s=[{name:"Carrier",length:5},{name:"Battleship",length:4},{name:"Destroyer",length:3},{name:"Submarine",length:3},{name:"Patrol Boat",length:2}],d=-1;async function u(){let e=r.loadStartScreen();await r.fadeIn(),function(e){e.addEventListener("click",x)}(e)}function p(){r.loadGameScreen(g,D),r.fadeIn()}function h(e,t,n,a){let s;s=a?"Computer":i.getName(),r.aiming(s),setTimeout((()=>{n?r.tileHit(e,t,a,s,n):r.tileMiss(e,t,a,s,n);let d=m();console.log(`Check winner: ${d}`),m()?(console.log("got here"),function(){let e=i.allSunk(),t=l.allSunk();e?r.gameover("Computer",M):t&&r.gameover(i.getName(),M)}()):a?c=!0:(console.log("Not player target"),setTimeout((()=>{!function(){console.log("Started computerAttack method");const e=o.attemptAttack();console.log(e),h(e.x,e.y,e.ship,!0)}()}),1500))}),1e3)}function m(){return i.allSunk()||l.allSunk()}function g(t){i=e(t),l=e("Computer"),y()}function f(){r.setGameLoopScreen(V);let e=i.getShips();e.forEach((e=>{r.placeShipOnGridGameLoop(e)})),o=new a(l,i,e),o.placeShips(),r.fadeIn()}function y(){d++,d>=s.length?(r.clearElement(document.querySelector(".info-container")),r.fadeOut(f)):r.loadShipSelect(G,s[d].name,s[d].length)}function v(e){let t=Number(e.dataset.x),n=Number(e.dataset.y);e.style.background="inherit";let a=Number(r.getCurrentShip().dataset.length),l=r.getCurrentShip().dataset.name;return!!i.checkPlaceable(a,t,n,r.placementIsVertical())&&(r.placeShipOnGrid(t,n,r.placementIsVertical()),i.attemptPlaceShip(a,t,n,r.placementIsVertical(),l),y(),!0)}function S(){i=null,l=null,o=null,d=-1,u()}function x(e){r.fadeOut(p),e.target.removeEventListener("click",x)}function C(e){}function k(e){e.target.style.opacity=0,e.dataTransfer.effectAllowed="move";let t=new Image;t.src=r.getCurrentShip().src,r.placementIsVertical()?e.dataTransfer.setDragImage(t,t.width/2,t.height-17.5):e.dataTransfer.setDragImage(t,17.5,t.height/2)}function E(e){e.target.style.opacity=1}function L(e){}function b(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function I(e){v(e.target)}function A(e){let t=Number(e.target.dataset.x),n=Number(e.target.dataset.y),a=Number(r.getCurrentShip().dataset.length);i.checkPlaceable(a,t,n,r.placementIsVertical())?e.target.style.background="green":e.target.style.background="red"}function P(e){e.target.style.background="inherit"}function T(){r.changeAxis()}function w(e){}function H(e){let t=e.targetTouches[0];e.target.style.position="absolute",r.placementIsVertical()?(e.target.style.left=t.pageX-e.target.width/2+"px",e.target.style.bottom=document.body.clientHeight-t.pageY-17.5+"px"):(e.target.style.top=t.pageY-e.target.height/2+"px",e.target.style.left=t.pageX-17.5+"px"),e.preventDefault()}function $(e){e.preventDefault();let t=e.changedTouches[0],n=r.getCurrentShip(),a=document.elementFromPoint(t.pageX,t.pageY);null!=a&&a.classList.contains("tile")&&v(a)||(n.style.position="relative",n.style.left="auto",n.style.bottom="auto",n.style.top="auto")}function q(e){let t=r.getCurrentShip();t.style.position="relative",t.style.left="auto",t.style.bottom="auto",t.style.top="auto"}function N(e){if(!c)return;let t=e.target.dataset.x,n=e.target.dataset.y,a=l.attemptReceiveAttack(t,n);console.log(a),h(t,n,a,!1),e.target.removeEventListener("click",N),c=!1}function G(e,t){"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?(e.addEventListener("touchstart",w),e.addEventListener("touchmove",H),e.addEventListener("touchend",$),e.addEventListener("touchcancel",q)):(e.addEventListener("dragstart",k),e.addEventListener("drag",C),e.addEventListener("dragend",E),e.addEventListener("dragover",L)),t.addEventListener("click",T)}function D(e){"ontouchstart"in window&&navigator.maxTouchPoints>0&&navigator.msMaxTouchPoints>0||(e.addEventListener("dragover",b),e.addEventListener("drop",I),e.addEventListener("dragenter",A),e.addEventListener("dragleave",P))}function V(e){e.addEventListener("click",N)}function M(e){e.addEventListener("click",S)}setTimeout(u,300),setTimeout(r.fadeInLogo,300)})()})();